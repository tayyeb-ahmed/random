# Create a COM object for WScript.Shell
$wsh = New-Object -ComObject WScript.Shell

# Infinite loop
while ($true) {
    # Try to activate the Teams process by process name
    $teamsProcess = Get-Process -Name "ms-teams" -ErrorAction SilentlyContinue
    if ($teamsProcess) {
        if ($wsh.AppActivate("Microsoft Teams")) {
            Write-Host "Microsoft Teams activated."
            Start-Sleep -Milliseconds 500 # Allow time for activation

            # Send CTRL+2 to Teams
            $wsh.SendKeys("^{2}")
            Start-Sleep -Milliseconds 500 # Allow time before ALT+TAB

            # Simulate ALT+TAB
            $wsh.SendKeys("%{TAB}")
            Write-Host "Switched window using ALT+TAB."
        } else {
            Write-Host "Failed to activate Microsoft Teams."
        }
    } else {
        Write-Host "Microsoft Teams process not found. Retrying..."
    }

    # Wait for 59 seconds before the next iteration
    Start-Sleep -Seconds 59
}
